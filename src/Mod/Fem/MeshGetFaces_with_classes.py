#!/usr/bin/env python
# -*- coding: utf-8 -*-
#
#  MeshGetElements.py
#
#  Copyright (C) 2016  Ulrich Brammer <ulrich1a@users.sourceforge.net>
#
#  This library is free software; you can redistribute it and/or
#  modify it under the terms of the GNU Lesser General Public
#  License as published by the Free Software Foundation; either
#  version 2.1 of the License, or (at your option) any later version.
#
#  This library is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
#  Lesser General Public License for more details.
#
#  You should have received a copy of the GNU Lesser General Public
#  License along with this library; if not, write to the Free Software
#  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, 
#  MA  02110-1301  USA

__title__="FreeCAD mesh get element test macro"
__author__ =  "Ulrich Brammer <ulrich1a@users.sourceforge.net>"
__url__ = ["http://www.freecadweb.org"]


'''Version 2 
Select Faces from an Object and the Analysis for this Object and run the macro

The Analysis needs to have a mesh

'''

import FreeCAD
import Fem
import FemMeshTools
#import ccxInpWriter
import time
import FreeCADGui



class MeshInfo(object):
  def __init__(self, theMesh):
    # the new node dictionary with element information
    # the node_dict contains for each node its membership in elements
    # stored informatation are: 
    # element number, the number of nodes per element, the position of the node in the element.
    # The position of the node in the element is coded as a set bit at that position in bit array (integer)
    # Fixme: the number of nodes per element should be replaced by the type of the element
    # but I did not know, how to get this from the mesh.
    self.node_dict = {}
    # initialize the node-dict so we get an ordered structure
    for node in theMesh.Nodes:
      self.node_dict[node]=[]
    # print node_dict

    # The ele_dict holds later an integer (bit array) for each element, which gives us
    # the information we are searching for:
    # Is this element part of the node list (searching for elements) or
    # has this element a face we are searching for?
    # The number in the ele_dict is organized as a bit array.
    # The corresponding bit is set, if the node of the node_list 
    # is contained in the element.
    self.ele_dict = {}

    # filling the node_dict
    for ele in theMesh.Volumes:
      self.ele_dict[ele] = 0 # initializing the ele_dict, in order to get an ordered structure
      eleList = theMesh.getElementNodes(ele)
      # print eleList
      theLen = len(eleList)
      pos = int(1)
      for elNode in eleList:
        self.node_dict[elNode].append([ele, theLen, pos])
        # x << n x shifted left by n bits = Multiplication
        pos = pos << 1
    # print node_dict

    # The node_dict and the initialized empty ele_dict can be reused for other searches.

  def getccx_faces(self, node_list):
    # Now we are looking for nodes inside of the Faces = filling the ele_dict
    e_dict = self.ele_dict.copy()
    for node in node_list:
      for nList in self.node_dict[node]:
        e_dict[nList[0]] = e_dict[nList[0]] + nList[2]
    print e_dict

    ele_list = [] # The ele_list contains the result of the search.
    for ele in e_dict:
      if (411 & e_dict[ele]) == 411:
        #print "411 Face P2: ", ele
        ele_list.append([ele, 'P2'])
      if (119 & e_dict[ele]) == 119:
        #print "119 Face P1: ", ele
        ele_list.append([ele, 'P1'])
      if (717 & e_dict[ele]) == 717:
        #print "717 Face P3: ", ele
        ele_list.append([ele, 'P3'])
      if (814 & e_dict[ele]) == 814:
        #print "814 Face P4: ", ele
        ele_list.append([ele, 'P4'])
    print "found Faces: ", len(ele_list)
    return ele_list


mylist = FreeCADGui.Selection.getSelectionEx()
mat_list = None
print 'The Selection: ',mylist
print 'count of Selections: ', mylist.__len__()

theFaceList = []

for o in FreeCADGui.Selection.getSelectionEx():
  print o.ObjectName

  if hasattr(o.Object,"Shape"):
    print 'The Object ', o.ObjectName, ' has a Shape.'
    if hasattr(o.Object.Shape,"Solids"):
      print 'The Object has ', len(o.Object.Shape.Solids), ' Solids.'
      theShape = o.Object.Shape.Solids[0]
    if hasattr(o.Object.Shape,"Faces"):
      print 'The Object has ', len(o.Object.Shape.Faces), ' Faces.'
      #theFaceList = o.Object.Shape.Faces

      for s in o.SubElementNames:
        print "SubElementName: ",s
      for s in o.SubObjects:
        print "object: ",s
        theFaceList.append(s)
      print 'theFaceList: ', theFaceList


  if o.ObjectName == 'Analysis':
    print 'found an Analysis'
    for s in o.Object.OutList:
      if s.TypeId == "App::MaterialObjectPython":
        print 'found a material: '
        if mat_list:
          mat_list.append(s)
        else:
          mat_list = [s]

      if s.TypeId == "Fem::FemMeshShapeNetgenObject":
        theMesh = s.FemMesh



if theMesh:
    ## This is the call of code of the current FEM-workbench
    # it measures the time to get the required node_list 
    nodeStart = time.clock()
    node_list = []
    if len(theFaceList) >0:
        for anFace in theFaceList:
            node_list = node_list + theMesh.getNodesByFace(anFace)
            print 'len(node_list): ', len(node_list)
            print 'the Face: ', anFace
    node_list = set(node_list) # This is needed to delete duplicates!
    #else:
        #node_list = theMesh.Nodes
    nodeEnd = time.clock()
    nodeTime = nodeEnd - nodeStart
    print 'node_list: ', node_list

    startZeit = time.clock()

    M_info = MeshInfo(theMesh)

    ccx_faces = M_info.getccx_faces(node_list)

    endZeit = time.clock()
    print 'node search time: ', nodeTime, ' Face search time: ', endZeit - startZeit


    startFemTime = time.clock()
    # here is the original code from FemMeshTools used to create the Volumes with Face info for ccx
    ref_face_volume_elements = []
    for ref_face in theFaceList:
        ref_face_volume_elements = ref_face_volume_elements + theMesh.getccxVolumesByFace(ref_face)
    print 'Original method faces: ', len(ref_face_volume_elements)
    endFemTime = time.clock()
    print 'Original method face search time: ', endFemTime - startFemTime

'''
pressureVessel_Part_withmesh

len(node_list): 13666
the Face: <Face object at 0x5c09e80>
len(node_list): 17245
the Face: <Face object at 0x5acb340>
node_list: set([1, 35134, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 34917, 33170, 34916, 34918, 35265, 34919, 34480, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 34923, 34924, 34481, 35354, 35457, 34925, 33390, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 33226, 33227, 33228, 33229, 33230, 33231, 33232, 33233, 33234, 33235, 33236, 33237, 33238, 33239, 33240, 33241, 33242, 33243, 33244, 33245, 33246, 33247, 33248, 33249, 33250, 33251, 33252, 33253, 33254, 33255, 33256, 33257, 33258, 33259, 33260, 33261, 33262, 33263, 33264, 33265, 33266, 33267, 33268, 33269, 33270, 33271, 33272, 33273, 33274, 33275, 33276, 33277, 33278, 33279, 33280, 33281, 33282, 33283, 33284, 33285, 33286, 33287, 33288, 33289, 33290, 33291, 33292, 33293, 33294, 33295, 33296, 33297, 33298, 33299, 33300, 33301, 33302, 33303, 33304, 33305, 33306, 33307, 33308, 33309, 33310, 33311, 33312, 33313, 33314, 33315, 33316, 33317, 33318, 33319, 33320, 33321, 33322, 33323, 33324, 33325, 33326, 33327, 33328, 33329, 33330, 33331, 33332, 33333, 33334, 33335, 33336, 33337, 33338, 33339, 33340, 33341, 33342, 33343, 33344, 33345, 33346, 33347, 33348, 33349, 33350, 33351, 33352, 33353, 33354, 33355, 33356, 33357, 33358, 33359, 33360, 33361, 33362, 33363, 33364, 33365, 33366, 33367, 33368, 33369, 33370, 33371, 33372, 33373, 33374, 33174, 33376, 33377, 33378, 33379, 33380, 33381, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750, 751, 752, 753, 754, 755, 756, 757, 758, 759, 760, 761, 762, 763, 764, 765, 766, 767, 768, 769, 770, 771, 772, 773, 774, 775, 776, 777, 778, 779, 780, 781, 782, 783, 784, 785, 786, 787, 788, 789, 790, 791, 792, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 904, 905, 906, 907, 908, 909, 910, 911, 912, 913, 914, 915, 916, 917, 918, 919, 920, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 936, 937, 938, 939, 940, 941, 942, 943, 944, 945, 946, 947, 948, 949, 950, 951, 952, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 968, 969, 970, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1000, 1001, 1002, 1003, 1004, 1005, 1006, 1007, 1008, 1009, 1010, 1011, 1012, 1013, 1014, 1015, 1016, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1032, 1033, 1034, 1035, 1036, 1037, 1038, 1039, 1040, 1041, 1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071, 1072, 1073, 1074, 1075, 1076, 1077, 1078, 1079, 1080, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1096, 1097, 1098, 1099, 1100, 1101, 1102, 1103, 1104, 1105, 1106, 1107, 1108, 1109, 1110, 1111, 1112, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136, 1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1160, 1161, 1162, 1163, 1164, 1165, 1166, 1167, 1168, 1169, 1170, 1171, 1172, 1173, 1174, 1175, 1176, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1192, 1193, 1194, 1195, 1196, 1197, 1198, 1199, 1200, 1201, 1202, 1203, 1204, 1205, 1206, 1207, 1208, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1224, 1225, 1226, 1227, 1228, 1229, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1238, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1256, 1257, 1258, 1259, 1260, 1261, 1262, 1263, 1264, 1265, 1266, 1267, 1268, 1269, 1270, 1271, 1272, 1273, 1274, 1275, 1276, 1277, 1278, 1279, 1280, 1281, 1282, 1283, 1284, 1285, 1286, 1287, 1288, 1289, 1290, 1291, 1292, 1293, 1294, 1295, 1296, 1297, 1298, 1299, 1300, 1301, 1302, 1303, 1304, 1305, 1306, 1307, 1308, 1309, 1310, 1311, 1312, 1313, 1314, 1315, 1316, 1317, 1318, 1319, 1320, 1321, 1322, 1323, 1324, 1325, 1326, 1327, 1328, 1329, 1330, 1331, 1332, 1333, 1334, 1335, 1336, 1337, 1338, 1339, 1340, 1341, 1342, 1343, 1344, 1345, 1346, 1347, 1348, 1349, 1350, 1351, 1352, 1353, 1354, 1355, 1356, 1357, 1358, 1359, 1360, 1361, 1362, 1363, 1364, 1365, 1366, 1367, 1368, 1369, 1370, 1371, 1372, 1373, 1374, 1375, 1376, 1377, 1378, 1379, 1380, 1381, 1382, 1383, 1384, 1385, 1386, 1387, 1388, 1389, 1390, 1391, 1392, 1393, 1394, 1395, 1396, 1397, 1398, 1399, 1400, 1401, 1402, 1403, 1404, 1405, 1406, 1407, 1408, 1409, 1410, 1411, 1412, 1413, 1414, 1415, 1416, 1417, 1418, 1419, 1420, 1421, 1422, 1423, 1424, 1425, 1426, 1427, 1428, 1429, 1430, 1431, 1432, 1433, 1434, 1435, 1436, 1437, 1438, 1439, 1440, 1441, 1442, 1443, 1444, 1445, 1446, 1447, 1448, 1449, 1450, 1451, 1452, 1453, 1454, 1455, 1456, 1457, 1458, 1459, 1460, 1461, 1462, 1463, 1464, 1465, 1466, 1467, 1468, 1469, 1470, 1471, 1472, 1473, 1474, 1475, 1476, 1477, 1478, 1479, 1480, 1481, 1482, 1483, 1484, 1485, 1486, 1487, 1488, 1489, 1490, 1491, 1492, 1493, 1494, 1495, 1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503, 1504, 1505, 1506, 1507, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 1515, 1516, 1517, 1518, 1519, 1520, 1521, 1522, 1523, 1524, 1525, 1526, 1527, 1528, 1529, 1530, 1531, 1532, 1533, 1534, 1535, 1536, 1537, 1538, 1539, 1540, 1541, 1542, 1543, 1544, 1545, 1546, 1547, 1548, 1549, 1550, 1551, 1552, 1553, 1554, 1555, 1556, 1557, 1558, 1559, 1560, 1561, 1562, 1563, 1564, 1565, 1566, 1567, 1568, 1569, 1570, 1571, 1572, 1573, 1574, 1575, 1576, 1577, 1578, 1579, 1580, 1581, 1582, 1583, 1584, 1585, 1586, 1587, 1588, 1589, 1590, 1591, 1592, 1593, 1594, 1595, 1596, 1597, 1598, 1599, 1600, 1601, 1602, 1603, 1604, 1605, 1606, 1607, 1608, 1609, 1610, 1611, 1612, 1613, 1614, 1615, 1616, 1617, 1618, 1619, 1620, 1621, 1622, 1623, 1624, 1625, 1626, 1627, 1628, 1629, 1630, 1631, 1632, 1633, 1634, 1635, 1636, 1637, 1638, 1639, 1640, 1641, 1642, 1643, 1644, 1645, 1646, 1647, 1648, 1649, 1650, 1651, 1652, 1653, 1654, 1655, 1656, 1657, 1658, 1659, 1660, 1661, 1662, 1663, 1664, 1665, 1666, 1667, 1668, 1669, 1670, 1671, 1672, 1673, 1674, 1675, 1676, 1677, 1678, 1679, 1680, 1681, 1682, 1683, 1684, 1685, 1686, 1687, 1688, 1689, 1690, 1691, 1692, 1693, 1694, 1695, 1696, 1697, 1698, 1699, 1700, 1701, 1702, 1703, 1704, 1705, 1706, 1707, 1708, 1709, 1710, 1711, 1712, 1713, 1714, 1715, 1716, 1717, 1718, 1719, 1720, 1721, 1722, 1723, 1724, 1725, 1726, 1727, 1728, 1729, 1730, 1731, 1732, 1733, 1734, 1735, 1736, 1737, 1738, 1739, 1740, 1741, 1742, 1743, 1744, 1745, 1746, 1747, 1748, 1749, 1750, 1751, 1752, 1753, 1754, 1755, 1756, 1757, 1758, 1759, 1760, 1761, 1762, 1763, 1764, 1765, 1766, 1767, 1768, 1769, 1770, 1771, 1772, 1773, 1774, 1775, 1776, 1777, 1778, 1779, 1780, 1781, 1782, 1783, 1784, 1785, 1786, 1787, 1788, 1789, 1790, 1791, 1792, 1793, 1794, 1795, 1796, 1797, 1798, 1799, 1800, 1801, 1802, 1803, 1804, 1805, 1806, 1807, 1808, 1809, 1810, 1811, 1812, 1813, 1814, 1815, 1816, 1817, 1818, 1819, 1820, 1821, 1822, 1823, 1824, 1825, 1826, 1827, 1828, 1829, 1830, 1831, 1832, 1833, 1834, 1835, 1836, 1837, 1838, 1839, 1840, 1841, 1842, 1843, 1844, 1845, 1846, 1847, 1848, 1849, 1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859, 1860, 1861, 1862, 1863, 1864, 1865, 1866, 1867, 1868, 1869, 1870, 1871, 1872, 1873, 1874, 1875, 1876, 1877, 1878, 1879, 1880, 1881, 1882, 1883, 1884, 1885, 1886, 1887, 1888, 1889, 1890, 1891, 1892, 1893, 1894, 1895, 1896, 1897, 1898, 1899, 1900, 1901, 1902, 1903, 1904, 1905, 1906, 1907, 1908, 1909, 1910, 1911, 1912, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923, 1924, 1
{18469: 8, 18470: 411, 18471: 19, 18472: 19, 18473: 717, 18474: 266, 18475: 1, 18476: 266, 18477: 411, 18478: 119, 18479: 524, 18480: 38, 18481: 1, 18482: 1, 18483: 814, 18484: 8, 18485: 8, 18486: 2, 18487: 2, 18488: 19, 18489: 266, 18490: 19, 18491: 8, 18492: 717, 18493: 19, 18494: 411, 18495: 814, 18496: 814, 18497: 38, 18498: 137, 18499: 69, 18500: 411, 18501: 8, 18502: 119, 18503: 119, 18504: 1, 18505: 266, 18506: 38, 18507: 266, 18508: 814, 18509: 411, 18510: 38, 18511: 1, 18512: 814, 18513: 1, 18514: 717, 18515: 119, 18516: 137, 18517: 137, 18518: 137, 18519: 1, 18520: 119, 18521: 717, 18522: 2, 18523: 137, 18524: 119, 18525: 137, 18526: 1, 18527: 814, 18528: 69, 18529: 137, 18530: 411, 18531: 137, 18532: 8, 18533: 38, 18534: 119, 18535: 8, 18536: 19, 18537: 119, 18538: 2, 18539: 8, 18540: 4, 18541: 4, 18542: 717, 18543: 137, 18544: 717, 18545: 2, 18546: 19, 18547: 411, 18548: 8, 18549: 411, 18550: 411, 18551: 4, 18552: 266, 18553: 411, 18554: 4, 18555: 69, 18556: 8, 18557: 524, 18558: 411, 18559: 814, 18560: 717, 18561: 2, 18562: 814, 18563: 2, 18564: 1, 18565: 38, 18566: 2, 18567: 19, 18568: 1, 18569: 8, 18570: 411, 18571: 69, 18572: 137, 18573: 717, 18574: 717, 18575: 717, 18576: 69, 18577: 119, 18578: 69, 18579: 411, 18580: 411, 18581: 266, 18582: 266, 18583: 1, 18584: 717, 18585: 8, 18586: 4, 18587: 2, 18588: 1, 18589: 38, 18590: 19, 18591: 814, 18592: 2, 18593: 2, 18594: 1, 18595: 411, 18596: 717, 18597: 814, 18598: 2, 18599: 38, 18600: 717, 18601: 19, 18602: 38, 18603: 119, 18604: 38, 18605: 411, 18606: 38, 18607: 119, 18608: 69, 18609: 524, 18610: 2, 18611: 19, 18612: 119, 18613: 19, 18614: 8, 18615: 411, 18616: 19, 18617: 266, 18618: 814, 18619: 266, 18620: 2, 18621: 411, 18622: 119, 18623: 814, 18624: 411, 18625: 19, 18626: 38, 18627: 411, 18628: 4, 18629: 19, 18630: 2, 18631: 2, 18632: 411, 18633: 411, 18634: 119, 18635: 119, 18636: 137, 18637: 814, 18638: 1, 18639: 814, 18640: 2, 18641: 4, 18642: 1, 18643: 411, 18644: 814, 18645: 411, 18646: 119, 18647: 38, 18648: 4, 18649: 1, 18650: 8, 18651: 4, 18652: 19, 18653: 411, 18654: 266, 18655: 717, 18656: 69, 18657: 2, 18658: 137, 18659: 119, 18660: 38, 18661: 814, 18662: 814, 18663: 1, 18664: 2, 18665: 4, 18666: 137, 18667: 4, 18668: 8, 18669: 38, 18670: 4, 18671: 717, 18672: 814, 18673: 69, 18674: 411, 18675: 1, 18676: 119, 18677: 717, 18678: 411, 18679: 2, 18680: 814, 18681: 524, 18682: 524, 18683: 717, 18684: 8, 18685: 69, 18686: 4, 18687: 2, 18688: 411, 18689: 2, 18690: 2, 18691: 4, 18692: 524, 18693: 411, 18694: 38, 18695: 4, 18696: 38, 18697: 411, 18698: 137, 18699: 69, 18700: 69, 18701: 19, 18702: 8, 18703: 4, 18704: 814, 18705: 8, 18706: 38, 18707: 411, 18708: 2, 18709: 4, 18710: 2, 18711: 1, 18712: 8, 18713: 524, 18714: 19, 18715: 411, 18716: 411, 18717: 1, 18718: 411, 18719: 717, 18720: 1, 18721: 717, 18722: 38, 18723: 19, 18724: 266, 18725: 1, 18726: 69, 18727: 2, 18728: 19, 18729: 19, 18730: 266, 18731: 137, 18732: 137, 18733: 137, 18734: 1, 18735: 119, 18736: 8, 18737: 69, 18738: 4, 18739: 2, 18740: 8, 18741: 814, 18742: 524, 18743: 814, 18744: 411, 18745: 19, 18746: 4, 18747: 1, 18748: 119, 18749: 4, 18750: 19, 18751: 2, 18752: 2, 18753: 2, 18754: 19, 18755: 137, 18756: 411, 18757: 814, 18758: 1, 18759: 119, 18760: 411, 18761: 411, 18762: 1, 18763: 1, 18764: 2, 18765: 266, 18766: 411, 18767: 717, 18768: 2, 18769: 814, 18770: 524, 18771: 2, 18772: 2, 18773: 137, 18774: 19, 18775: 411, 18776: 524, 18777: 717, 18778: 717, 18779: 266, 18780: 119, 18781: 266, 18782: 137, 18783: 717, 18784: 411, 18785: 19, 18786: 137, 18787: 119, 18788: 4, 18789: 717, 18790: 814, 18791: 411, 18792: 717, 18793: 411, 18794: 524, 18795: 4, 18796: 38, 18797: 69, 18798: 69, 18799: 137, 18800: 411, 18801: 2, 18802: 717, 18803: 119, 18804: 38, 18805: 2, 18806: 2, 18807: 119, 18808: 411, 18809: 2, 18810: 119, 18811: 524, 18812: 119, 18813: 4, 18814: 38, 18815: 38, 18816: 19, 18817: 4, 18818: 2, 18819: 266, 18820: 717, 18821: 2, 18822: 8, 18823: 814, 18824: 1, 18825: 1, 18826: 69, 18827: 8, 18828: 8, 18829: 524, 18830: 8, 18831: 2, 18832: 137, 18833: 1, 18834: 2, 18835: 119, 18836: 38, 18837: 8, 18838: 524, 18839: 1, 18840: 1, 18841: 69, 18842: 4, 18843: 19, 18844: 19, 18845: 4, 18846: 814, 18847: 266, 18848: 411, 18849: 137, 18850: 524, 18851: 411, 18852: 4, 18853: 1, 18854: 411, 18855: 19, 18856: 2, 18857: 1, 18858: 38, 18859: 8, 18860: 717, 18861: 38, 18862: 8, 18863: 2, 18864: 2, 18865: 38, 18866: 119, 18867: 1, 18868: 19, 18869: 1, 18870: 69, 18871: 4, 18872: 1, 18873: 2, 18874: 717, 18875: 4, 18876: 38, 18877: 524, 18878: 814, 18879: 411, 18880: 1, 18881: 137, 18882: 717, 18883: 69, 18884: 19, 18885: 38, 18886: 19, 18887: 411, 18888: 137, 18889: 8, 18890: 411, 18891: 1, 18892: 8, 18893: 19, 18894: 814, 18895: 1, 18896: 2, 18897: 814, 18898: 814, 18899: 814, 18900: 814, 18901: 119, 18902: 2, 18903: 19, 18904: 266, 18905: 524, 18906: 814, 18907: 2, 18908: 717, 18909: 411, 18910: 38, 18911: 814, 18912: 411, 18913: 2, 18914: 411, 18915: 8, 18916: 38, 18917: 411, 18918: 1, 18919: 119, 18920: 19, 18921: 717, 18922: 137, 18923: 2, 18924: 19, 18925: 119, 18926: 814, 18927: 69, 18928: 119, 18929: 1, 18930: 2, 18931: 411, 18932: 411, 18933: 411, 18934: 1, 18935: 266, 18936: 8, 18937: 266, 18938: 137, 18939: 19, 18940: 2, 18941: 2, 18942: 524, 18943: 717, 18944: 19, 18945: 524, 18946: 119, 18947: 1, 18948: 717, 18949: 69, 18950: 814, 18951: 19, 18952: 19, 18953: 19, 18954: 411, 18955: 411, 18956: 2, 18957: 4, 18958: 524, 18959: 2, 18960: 119, 18961: 69, 18962: 38, 18963: 717, 18964: 137, 18965: 717, 18966: 38, 18967: 717, 18968: 524, 18969: 2, 18970: 717, 18971: 1, 18972: 717, 18973: 119, 18974: 4, 18975: 2, 18976: 266, 18977: 38, 18978: 411, 18979: 38, 18980: 266, 18981: 69, 18982: 1, 18983: 4, 18984: 69, 18985: 19, 18986: 19, 18987: 137, 18988: 814, 18989: 2, 18990: 1, 18991: 717, 18992: 1, 18993: 266, 18994: 814, 18995: 814, 18996: 524, 18997: 1, 18998: 411, 18999: 119, 19000: 266, 19001: 4, 19002: 4, 19003: 717, 19004: 814, 19005: 1, 19006: 2, 19007: 1, 19008: 717, 19009: 2, 19010: 38, 19011: 1, 19012: 814, 19013: 137, 19014: 69, 19015: 411, 19016: 717, 19017: 119, 19018: 4, 19019: 2, 19020: 19, 19021: 137, 19022: 69, 19023: 814, 19024: 717, 19025: 814, 19026: 19, 19027: 119, 19028: 19, 19029: 19, 19030: 411, 19031: 119, 19032: 1, 19033: 4, 19034: 411, 19035: 4, 19036: 19, 19037: 4, 19038: 8, 19039: 814, 19040: 814, 19041: 524, 19042: 38, 19043: 266, 19044: 814, 19045: 1, 19046: 266, 19047: 814, 19048: 8, 19049: 8, 19050: 38, 19051: 38, 19052: 69, 19053: 19, 19054: 717, 19055: 119, 19056: 119, 19057: 411, 19058: 119, 19059: 411, 19060: 19, 19061: 2, 19062: 8, 19063: 69, 19064: 19, 19065: 2, 19066: 38, 19067: 524, 19068: 8, 19069: 411, 19070: 814, 19071: 4, 19072: 8, 19073: 137, 19074: 2, 19075: 717, 19076: 266, 19077: 814, 19078: 1, 19079: 2, 19080: 69, 19081: 2, 19082: 1, 19083: 266, 19084: 266, 19085: 19, 19086: 8, 19087: 4, 19088: 1, 19089: 137, 19090: 2, 19091: 1, 19092: 8, 19093: 4, 19094: 69, 19095: 411, 19096: 38, 19097: 2, 19098: 119, 19099: 8, 19100: 137, 19101: 411, 19102: 524, 19103: 119, 19104: 2, 19105: 8, 19106: 19, 19107: 38, 19108: 411, 19109: 38, 19110: 524, 19111: 119, 19112: 1, 19113: 119, 19114: 119, 19115: 1, 19116: 1, 19117: 1, 19118: 119, 19119: 1, 19120: 8, 19121: 69, 19122: 38, 19123: 524, 19124: 411, 19125: 411, 19126: 19, 19127: 137, 19128: 4, 19129: 814, 19130: 1, 19131: 266, 19132: 717, 19133: 119, 19134: 2, 19135: 2, 19136: 4, 19137: 524, 19138: 717, 19139: 69, 19140: 119, 19141: 119, 19142: 4, 19143: 137, 19144: 814, 19145: 266, 19146: 814, 19147: 524, 19148: 524, 19149: 2, 19150: 137, 19151: 814, 19152: 19, 19153: 38, 19154: 4, 19155: 4, 19156: 69, 19157: 69, 19158: 2, 19159: 8, 19160: 8, 19161: 8, 19162: 411, 19163: 266, 19164: 2, 19165: 717, 19166: 119, 19167: 1, 19168: 524, 19169: 69, 19170: 1, 19171: 717, 19172: 2, 19173: 69, 19174: 2, 19175: 411, 19176: 4, 19177: 524, 19178: 69, 19179: 8, 19180: 411, 19181: 38, 19182: 814, 19183: 814, 19184: 1, 19185: 717, 19186: 19, 19187: 814, 19188: 19, 19189: 69, 19190: 38, 19191: 1, 19192: 19, 19193: 2, 19194: 524, 19195: 2, 19196: 119, 19197: 8, 19198: 2, 19199: 266, 19200: 4, 19201: 2, 19202: 4, 19203: 69, 19204: 814, 19205: 524, 19206: 411, 19207: 524, 19208: 2, 19209: 19, 19210: 69, 19211: 266, 19212: 19, 19213: 1, 19214: 717, 19215: 19, 19216: 2, 19217: 19, 19218: 814, 19219: 4, 19220: 2, 19221: 524, 19222: 411, 19223: 266, 19224: 8, 19225: 137, 19226: 2, 19227: 4, 19228: 2, 19229: 411, 19230: 814, 19231: 38, 19232: 119, 19233: 411, 19234: 1, 19235: 411, 19236: 717, 19237: 524, 19238: 69, 19239: 524, 19240: 1, 19241: 717, 19242: 119, 19243: 119, 19244: 266, 19245: 266, 19246: 19, 19247: 2, 19248: 69, 19249: 8, 19250: 266, 19251: 814, 19252: 69, 19253: 1, 19254: 411, 19255: 8, 19256: 717, 19257: 717, 19258: 19, 19259: 2, 19260: 524, 19261: 69, 19262: 1, 19263: 8, 19264: 1, 19265: 411, 19266: 717, 19267: 4, 19268: 814, 19269: 4, 19270: 814, 19271: 717, 19272: 717, 19273: 19, 19274: 19, 19275: 8, 19276: 69, 19277: 19, 19278: 814, 19279: 717, 19280: 137, 19281: 69, 19282: 266, 19283: 524, 19284: 4, 19285: 814, 19286: 411, 19287: 524, 19288: 19, 19289: 717, 19290: 2, 19291: 69, 19292: 69, 19293: 814, 19294: 411, 19295: 69, 19296: 2, 19297: 814, 19298: 4, 19299: 38, 19300: 119, 19301: 137, 19302: 8, 19303: 8, 19304: 2, 19305: 2, 19306: 717, 19307: 266, 19308: 411, 19309: 814, 19310: 19, 19311: 814, 19312: 524, 19313: 411, 19314: 524, 19315: 8, 19316: 524, 19317: 717, 19318: 2, 19319: 814, 19320: 411, 19321: 524, 19322: 19, 19323: 1, 19324: 119, 19325: 137, 19326: 8, 19327: 2, 19328: 1, 19329: 1, 19330: 266, 19331: 2, 19332: 4, 19333: 8, 19334: 69, 19335: 4, 19336: 4, 19337: 8, 19338: 2, 19339: 119, 19340: 119, 19341: 2, 19342: 814, 19343: 814, 19344: 814, 19345: 119, 19346: 411, 19347: 2, 19348: 411, 19349: 266, 19350: 1, 19351: 19, 19352: 119, 19353: 137, 19354: 1, 19355: 1, 19356: 411, 19357: 2, 19358: 524, 19359: 119, 19360: 411, 19361: 524, 19362: 717, 19363: 717, 19364: 814, 19365: 19, 
found Faces: 8411
node search time: 11.487136 Face search time: 0.904152
Original method faces: 8411
Original method face search time: 32.859372
'''